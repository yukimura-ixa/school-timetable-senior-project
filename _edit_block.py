import pathlib
path = pathlib.Path(r"src/app/dashboard/[semesterAndyear]/all-timeslot/AllTimeslotClient.tsx")
text = path.read_text(encoding="utf-8").replace('\r\n', '\n')
marker = '        <Stack\n            direction={isTablet ? "column" : "row"}\n            justifyContent="space-between"\n            alignItems={isTablet ? "flex-start" : "center"}\n            spacing={2}\n            className="no-print"\n          >'
start = text.index(marker)
end = text.index('        <Box', start)
new_block = '''        <Stack\n            direction={isTablet ? "column" : "row"}\n            justifyContent="space-between"\n            alignItems={isTablet ? "flex-start" : "center"}\n            spacing={2}\n            className="no-print"\n          >\n            <Stack direction="row" spacing={2} flexWrap="wrap">\n              <Button\n                variant="contained"\n                startIcon={<FilterListIcon />}\n                onClick={() => window.scrollTo({ top: 0, behavior: "smooth" })}\n              >\n                ปรับตัวกรอง\n              </Button>\n              {isAdmin ? (\n                <>\n                  <Button\n                    variant="outlined"\n                    startIcon={<SwapVertIcon />}\n                    onClick={handleExportExcel}\n                  >\n                    ส่งออก Excel\n                  </Button>\n                  <Button\n                    variant="outlined"\n                    startIcon={<SummarizeIcon />}\n                    onClick={handleExportSummary}\n                  >\n                    สรุปสำหรับครู\n                  </Button>\n                </>\n              ) : (\n                <>\n                  <Tooltip title={exportDisabledTooltip}>\n                    <span>\n                      <Button\n                        variant="outlined"\n                        startIcon={<SwapVertIcon />}\n                        disabled\n                      >\n                        ส่งออก Excel\n                      </Button>\n                    </span>\n                  </Tooltip>\n                  <Tooltip title={exportDisabledTooltip}>\n                    <span>\n                      <Button\n                        variant="outlined"\n                        startIcon={<SummarizeIcon />}\n                        disabled\n                      >\n                        สรุปสำหรับครู\n                      </Button>\n                    </span>\n                  </Tooltip>\n                </>\n              )}\n              <Button\n                variant="outlined"\n                startIcon={<PrintIcon />}\n                onClick={handlePrint}\n              >\n                พิมพ์\n              </Button>\n            </Stack>\n\n            <Stack direction="row" spacing={1} alignItems="center">\n              <Tooltip\n                title={isAdmin ? "เมนูเพิ่มเติม" : exportDisabledTooltip}\n              >\n                <span>\n                  <IconButton\n                    onClick={handleExportMenuOpen}\n                    disabled={!isAdmin}\n                    aria-label="ตัวเลือกส่งออกเพิ่มเติม"\n                  >\n                    <MoreVertIcon />\n                  </IconButton>\n                </span>\n              </Tooltip>\n              {isAdmin && (\n                <Menu\n                  anchorEl={exportMenuAnchor}\n                  open={Boolean(exportMenuAnchor)}\n                  onClose={handleExportMenuClose}\n                >\n                  <MenuItem onClick={handleExportExcel}>\n                    <DownloadIcon fontSize="small" sx={{ mr: 1 }} />\n                    ส่งออก Excel\n                  </MenuItem>\n                  <MenuItem onClick={handleExportSummary}>\n                    <SummarizeIcon fontSize="small" sx={{ mr: 1 }} />\n                    สรุปสำหรับครู\n                  </MenuItem>\n                  <MenuItem onClick={handlePrint}>\n                    <PictureAsPdfIcon fontSize="small" sx={{ mr: 1 }} />\n                    พิมพ์ PDF\n                  </MenuItem>\n                </Menu>\n              )}\n            </Stack>\n          </Stack>\n\n        '''
text = text[:start] + new_block + text[end:]
path.write_text(text.replace('\n', '\r\n'), encoding="utf-8")
