[dotenv@17.2.3] injecting env (11) from .env.test -- tip: เนยโเธ sync secrets across teammates & machines: https://dotenvx.com/ops
SKIP_WEBSERVER: true
[dotenv@17.2.3] injecting env (0) from .env.test -- tip: เนยยเนเธย  load multiple .env files with { path: ['.env.local', '.env'] }
เนยโย Using AUTH_SECRET from .env.test (length=27)

เนยโเธ E2E Test Setup: Initializing test environment...

เนยยเนเธย  .env.local not found - run `node scripts/prepare-e2e-env.js` first

   AUTH_SECRET checksum: dGVzdGluเนโฌเธ
เนยยเธ Docker Compose lifecycle management: ENABLED

เนยเธเนเธย  Test database is already running
   Reusing existing database instance

เนยยเธ Seeding test database...

เนยเธเธ Cleared cached Playwright auth storage state
เนยยเธ Running test database seed with .env.test configuration...

> school-timetable@2.0.0 test:db:seed B:\Dev\school-timetable-senior-project
> dotenv -e .env.test -- tsx prisma/seed.ts

เนยยเธ Starting MOE-compliant seed with retry logic...
เนยโเธ Connection: postgresql://test_user:test_password@127.0.0.1:543...
เนยโเธ Creating admin user...
เนยเธเนเธย  Admin user already exists
เนยเธเธ Test mode enabled - Seeding E2E test data...
เนยเธเธ Cleaning existing data...
เนยโย Cleaning auth sessions for test mode...
เนยโฆ Auth sessions cleaned
เนยโฆ Timetable data cleaned (Auth.js tables preserved)
เนยโย Creating subjects with MOE 8 Learning Areas...
เนยโฆ Created 82 subjects (48 core + 25 additional + 9 activities)
เนยยโ Creating programs...
เนยโฆ Created 18 programs (3 tracks เธฃโ 6 years)
เนยยเธ Creating grade levels with program assignments...
เนยโฆ Created 18 grade levels with program assignments
เนยยเธ Creating rooms...
เนยโฆ Created 40 rooms across 3 buildings
เนยโเธเนโฌยเนยยเธ Creating teachers (target: 40)...
เนยโฆ Created 40 teachers across 8 departments
เนยเธ Creating timeslots...
เนยโฆ Created 40 timeslots for Semester 1 (5 days เธฃโ 8 periods)
เนยเธ Creating timeslots for Semester 2...
เนยโฆ Created 40 timeslots for Semester 2 (5 days เธฃโ 8 periods)
เนยยเนเธย  Creating timetable configuration...
เนยโฆ Created timetable configuration
เนยโโ Assigning subjects to M.1 programs...
เนยโฆ Assigned 14 subjects to M.1 Science-Math program
เนยเธเนเธย  Other programs can be populated similarly via the UI or additional seed logic
เนยโย Creating sample teacher responsibilities...
เนยโฆ Created 21 sample teacher responsibilities
เนยโโฆ Creating sample locked schedules for activities...
เนยโฆ Created 0 sample locked schedules

======================================================================
เนยยย MOE-Compliant Seed Completed Successfully!
======================================================================
เนยโย Database Summary:
   เนโฌเธ Programs: 18 (3 tracks เธฃโ 6 years)
   เนโฌเธ Grade Levels: 18 (M.1-M.6, 3 sections each)
   เนโฌเธ Rooms: 40 (3 buildings)
   เนโฌเธ Teachers: 40 (8 departments; target 40 met)
   เนโฌเธ Subjects: 82 subjects
     - Core (8 learning areas): 48
     - Additional (track-specific): 25
     - Activities (MOE-compliant): 9
   เนโฌเธ Timeslots: 80 (Semester 1: 40, Semester 2: 40)
   เนโฌเธ Teacher Responsibilities: 21
   เนโฌเธ Sample Locked Schedules: 0
   เนโฌเธ Table Configurations: 1
======================================================================

เนยเธ Your MOE-compliant database is ready!
เนยโเธ Features included:
   - เนยโฆ Retry logic for Docker Desktop connection stability
   - เนยโฆ MOE 8 Learning Areas structure
   - เนยโฆ Proper ActivityType (เนเธยเนเธเธเนเธเธเนเธยเนเธเธเนเธเธ, เนเธเธเนเธเธเนเธยเนเธโฌเนเธเธเนเธเธเนเธเธ, เนเธยเนเธยเนเธเธเนเธยเนเธยเนเธเธ, เนเธยเนเธเธเนเธยเนเธยเนเธเธเนเธเธเนเธเธเนเธโฌเนเธยเนเธเธเนเธยเนเธเธเนเธเธเนเธเธเนเธยเนเธยเนเธเธ)
   - เนยโฆ Three program tracks (เนเธเธเนเธเธเนเธโเนเธเธเนเธย-เนเธยเนเธโเนเธเธเนเธโข, เนเธเธเนเธเธเนเธเธเนเธยเนเธย-เนเธยเนเธเธเนเธยเนเธเธเนเธโ, เนเธเธเนเธเธเนเธเธเนเธยเนเธย-เนเธยเนเธเธเนเธเธเนเธเธ)
   - เนยโฆ Realistic teacher workload (1-3 subjects per Ministry standard)
   - เนยโฆ Locked timeslots for school-wide activities
   - เนยโฆ Grade-program assignments
======================================================================

เนยโฆ Test environment ready!

   Database: postgresql://localhost:5433/test_timetable
   Tests: 27 E2E tests ready to run


Running 3 tests using 2 workers

[1A[2K[dotenv@17.2.3] injecting env (0) from .env.test -- tip: เนยยเนเธย  specify custom .env file path with { path: '/custom/path/.env' }

[1A[2KSKIP_WEBSERVER: true

[1A[2K[1/3] [setup] เนโฌเธ e2e\auth.setup.ts:32:1 เนโฌเธ authenticate as admin
[1A[2K[setup] เนโฌเธ e2e\auth.setup.ts:32:1 เนโฌเธ authenticate as admin
[AUTH SETUP] Starting authentication flow...

[1A[2K  1) [setup] เนโฌเธ e2e\auth.setup.ts:32:1 เนโฌเธ authenticate as admin เนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌ

    Error: page.goto: net::ERR_CONNECTION_REFUSED at http://localhost:3000/signin
    Call log:
    [2m  - navigating to "http://localhost:3000/signin", waiting until "load"[22m


      38 |   // Navigate to custom sign-in page
      39 |   // Increased timeout to 60s for initial page load/compilation
    > 40 |   await page.goto('http://localhost:3000/signin', { timeout: 60000 })
         |              ^
      41 |   console.log('[AUTH SETUP] Navigated to signin page')
      42 |
      43 |   // Wait for the page to load
        at B:\Dev\school-timetable-senior-project\e2e\auth.setup.ts:40:14

    attachment #1: screenshot (image/png) เนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌ
    test-results\artifacts\auth.setup.ts-authenticate-as-admin-setup\test-failed-1.png
    เนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌ

    attachment #2: video (video/webm) เนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌ
    test-results\artifacts\auth.setup.ts-authenticate-as-admin-setup\video.webm
    เนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌ



เนยเธเธ E2E Test Teardown: Cleaning up...

เนยเธเนเธย  Test database managed externally - skipping cleanup

[1A[2K  1 failed
    [setup] เนโฌเธ e2e\auth.setup.ts:32:1 เนโฌเธ authenticate as admin เนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌเนโโฌ
  2 did not run
